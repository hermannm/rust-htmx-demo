(function(){var c;htmx.defineExtension("sse",{init:function(e){c=e;if(htmx.createEventSource==undefined){htmx.createEventSource=t}},onEvent:function(e,t){var n=t.target||t.detail.elt;switch(e){case"htmx:beforeCleanupElement":var r=c.getInternalData(n);if(r.sseEventSource){r.sseEventSource.close()}return;case"htmx:afterProcessNode":s(n)}}});function t(e){return new EventSource(e,{withCredentials:true})}function i(e){return e.trim().split(/\s+/)}function r(e){var t=c.getAttributeValue(e,"hx-sse");if(t){var n=i(t);for(var r=0;r<n.length;r++){var a=n[r].split(/:(.+)/);if(a[0]==="connect"){return a[1]}}}}function l(e){var t=c.getAttributeValue(e,"hx-sse");var n=[];if(t!=null){var r=i(t);for(var a=0;a<r.length;a++){var s=r[a].split(/:(.+)/);if(s[0]==="swap"){n.push(s[1])}}}return n}function a(f){o(f,"sse-swap").forEach(function(t){var n=c.getClosestMatch(t,h);if(n==null){return null}var e=c.getInternalData(n);var r=e.sseEventSource;var a=c.getAttributeValue(t,"sse-swap");if(a){var s=a.split(",")}else{var s=l(t)}for(var i=0;i<s.length;i++){var u=s[i].trim();var o=function(e){if(v(n)){return}if(!c.bodyContains(t)){r.removeEventListener(u,o);return}if(!c.triggerEvent(f,"htmx:sseBeforeMessage",e)){return}g(t,e.data);c.triggerEvent(f,"htmx:sseMessage",e)};c.getInternalData(t).sseEventListener=o;r.addEventListener(u,o)}});o(f,"hx-trigger").forEach(function(e){var t=c.getClosestMatch(e,h);if(t==null){return null}var n=c.getInternalData(t);var r=n.sseEventSource;var a=c.getAttributeValue(e,"hx-trigger");if(a==null){return}if(a.slice(0,4)!="sse:"){return}a=a.substr(4);var s=function(){if(v(t)){return}if(!c.bodyContains(e)){r.removeEventListener(a,s)}}})}function s(e,n){if(e==null){return null}o(e,"sse-connect").forEach(function(e){var t=c.getAttributeValue(e,"sse-connect");if(t==null){return}u(e,t,n)});o(e,"hx-sse").forEach(function(e){var t=r(e);if(t==null){return}u(e,t,n)});a(e)}function u(n,e,r){var a=htmx.createEventSource(e);a.onerror=function(e){c.triggerErrorEvent(n,"htmx:sseError",{error:e,source:a});if(v(n)){return}if(a.readyState===EventSource.CLOSED){r=r||0;var t=Math.random()*(2^r)*500;window.setTimeout(function(){s(n,Math.min(7,r+1))},t)}};a.onopen=function(e){c.triggerEvent(n,"htmx:sseOpen",{source:a})};c.getInternalData(n).sseEventSource=a}function v(e){if(!c.bodyContains(e)){var t=c.getInternalData(e).sseEventSource;if(t!=undefined){t.close();return true}}return false}function o(e,t){var n=[];if(c.hasAttribute(e,t)){n.push(e)}e.querySelectorAll("["+t+"], [data-"+t+"]").forEach(function(e){n.push(e)});return n}function g(t,n){c.withExtensions(t,function(e){n=e.transformResponse(n,null,t)});var e=c.getSwapSpecification(t);var r=c.getTarget(t);var a=c.makeSettleInfo(t);c.selectAndSwap(e.swapStyle,r,t,n,a);a.elts.forEach(function(e){if(e.classList){e.classList.add(htmx.config.settlingClass)}c.triggerEvent(e,"htmx:beforeSettle")});if(e.settleDelay>0){setTimeout(f(a),e.settleDelay)}else{f(a)()}}function f(e){return function(){e.tasks.forEach(function(e){e.call()});e.elts.forEach(function(e){if(e.classList){e.classList.remove(htmx.config.settlingClass)}c.triggerEvent(e,"htmx:afterSettle")})}}function h(e){return c.getInternalData(e).sseEventSource!=null}})();